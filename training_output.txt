ğŸ¯ Unified AQI Model Training Pipeline
ğŸ• Pipeline started at: 2026-01-29 02:35:08 PKT
======================================================================

============================================================
ğŸš€ Training RandomForest Model
â° Started at: 2026-01-29 02:35:11 PKT
============================================================
ğŸš€ Starting AQI Random Forest Training Pipeline...
============================================================
ğŸ“ Output directory: randomforest_additional/01_29_2026_0235_pkt

ğŸ“Š Step 1: Fetching data from Hopsworks...
ğŸ”— Connecting to Hopsworks project: anassale
2026-01-29 02:35:11,225 INFO: Initializing external client
2026-01-29 02:35:11,225 INFO: Base URL: https://c.app.hopsworks.ai:443
2026-01-29 02:35:11,867 INFO: Python Engine initialized.
Traceback (most recent call last):
  File "/home/runner/work/aqi-predictor-10-pearls/aqi-predictor-10-pearls/aqi_randomforest_training_pipeline.py", line 865, in main
    splits, df_sorted = create_time_series_splits(df_processed)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/aqi-predictor-10-pearls/aqi-predictor-10-pearls/aqi_randomforest_training_pipeline.py", line 430, in create_time_series_splits
    for train_index, test_index in tscv.split(df_sorted):
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sklearn/model_selection/_split.py", line 1301, in _split
    raise ValueError(
ValueError: Too many splits=5 for number of samples=10880 with test_size=2176 and gap=0.

Logged in to project, explore it here https://c.app.hopsworks.ai:443/p/1263764
âœ… Successfully connected to Hopsworks
âœ… Latest version of karachifeatures10: 1
ğŸ“¥ Retrieving features from: karachifeatures10 (v1)
ğŸ“‹ Retrieving all records...
Reading data from Hopsworks, using Hopsworks Feature Query Service.   Reading data from Hopsworks, using Hopsworks Feature Query Service..   Finished: Reading data from Hopsworks, using Hopsworks Feature Query Service (0.60s) 
ğŸ”„ Sorting data by datetime for chronological order...
âœ… Successfully retrieved 10885 records
ğŸ“Š Shape: (10885, 25)

ğŸ”§ Step 2: Preprocessing data...
ğŸ”§ Preprocessing data...
   ğŸ§¹ Handling missing values...
   ğŸ“Š Ensuring engineered features are properly calculated...
   â• Creating lag features for pollutants...
   â• Creating lag features for pm2_5_nowcast...
   â• Creating lag features for pm10_nowcast...
   â• Creating lag features for co_ppm_8hr_avg...
   â• Creating lag features for no2_ppb...
   âœ… After preprocessing: 10880 records

ğŸ“Š Step 3: Creating time series splits...
ğŸ“Š Creating time series splits...

âŒ Error in training pipeline: Too many splits=5 for number of samples=10880 with test_size=2176 and gap=0.

âœ… RandomForest training completed successfully!
   Result: (None, None, None)

============================================================
ğŸš€ Training LightGBM Model
â° Started at: 2026-01-29 02:35:14 PKT
============================================================
ğŸš€ Starting AQI LGBM Training Pipeline
============================================================
ğŸ“ Attempting to load data from RandomForest CSV first...
âŒ No RandomForest CSV files found, trying general CSV files...
ğŸ”— Connecting to Hopsworks project: anassale
2026-01-29 02:35:14,518 INFO: Closing external client and cleaning up certificates.
Connection closed.
2026-01-29 02:35:14,520 INFO: Initializing external client
2026-01-29 02:35:14,520 INFO: Base URL: https://c.app.hopsworks.ai:443
2026-01-29 02:35:15,187 INFO: Python Engine initialized.
Traceback (most recent call last):
  File "/home/runner/work/aqi-predictor-10-pearls/aqi-predictor-10-pearls/aqi_lgbm_training_pipeline.py", line 819, in main
    splits, df_sorted = create_time_series_splits(df_processed)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/aqi-predictor-10-pearls/aqi-predictor-10-pearls/aqi_lgbm_training_pipeline.py", line 367, in create_time_series_splits
    for train_index, test_index in tscv.split(df_sorted):
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sklearn/model_selection/_split.py", line 1301, in _split
    raise ValueError(
ValueError: Too many splits=5 for number of samples=10880 with test_size=2176 and gap=0.

Logged in to project, explore it here https://c.app.hopsworks.ai:443/p/1263764
âœ… Successfully connected to Hopsworks
âœ… Latest version of karachifeatures10: 1
ğŸ“¥ Retrieving features from: karachifeatures10 (v1)
ğŸ“‹ Retrieving all records...
Reading data from Hopsworks, using Hopsworks Feature Query Service.   Reading data from Hopsworks, using Hopsworks Feature Query Service..   Finished: Reading data from Hopsworks, using Hopsworks Feature Query Service (0.84s) 
ğŸ”„ Sorting data by datetime for chronological order...
âœ… Successfully retrieved 10885 records
ğŸ“Š Shape: (10885, 25)
ğŸ”§ Preprocessing data...
   ğŸ§¹ Handling missing values...
   ğŸ“Š Ensuring engineered features are properly calculated...
   â• Creating lag features for pollutants...
   â• Creating lag features for pm2_5_nowcast...
   â• Creating lag features for pm10_nowcast...
   â• Creating lag features for co_ppm_8hr_avg...
   â• Creating lag features for no2_ppb...
   âœ… After preprocessing: 10880 records
ğŸ“Š Final dataset shape: (10880, 22)
ğŸ¯ Target variable range: 9.0 - 500.0
ğŸ“Š Creating time series splits...
âŒ Pipeline failed: Too many splits=5 for number of samples=10880 with test_size=2176 and gap=0.

âœ… LightGBM training completed successfully!
   Result: None

============================================================
ğŸš€ Training XGBoost Model
â° Started at: 2026-01-29 02:35:17 PKT
============================================================
ğŸš€ Starting AQI XGBoost Training Pipeline...
============================================================
ğŸ“ Output directory: xgboost_additional/01_29_2026_0235_pkt

ğŸ“Š Step 1: Fetching data from Hopsworks...
ğŸ“ Attempting to load data from RandomForest CSV first...
âŒ No RandomForest CSV files found, trying general CSV files...
ğŸ”— Connecting to Hopsworks project: anassale
2026-01-29 02:35:17,701 INFO: Closing external client and cleaning up certificates.
Connection closed.
2026-01-29 02:35:17,703 INFO: Initializing external client
2026-01-29 02:35:17,703 INFO: Base URL: https://c.app.hopsworks.ai:443
2026-01-29 02:35:18,383 INFO: Python Engine initialized.
Traceback (most recent call last):
  File "/home/runner/work/aqi-predictor-10-pearls/aqi-predictor-10-pearls/aqi_xgboost_training_pipeline.py", line 818, in main
    splits, df_sorted = create_time_series_splits(df_processed)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/aqi-predictor-10-pearls/aqi-predictor-10-pearls/aqi_xgboost_training_pipeline.py", line 366, in create_time_series_splits
    for train_index, test_index in tscv.split(df_sorted):
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sklearn/model_selection/_split.py", line 1301, in _split
    raise ValueError(
ValueError: Too many splits=5 for number of samples=10880 with test_size=2176 and gap=0.

Logged in to project, explore it here https://c.app.hopsworks.ai:443/p/1263764
âœ… Successfully connected to Hopsworks
âœ… Latest version of karachifeatures10: 1
ğŸ“¥ Retrieving features from: karachifeatures10 (v1)
ğŸ“‹ Retrieving all records...
Reading data from Hopsworks, using Hopsworks Feature Query Service.   Reading data from Hopsworks, using Hopsworks Feature Query Service..   Finished: Reading data from Hopsworks, using Hopsworks Feature Query Service (0.67s) 
ğŸ”„ Sorting data by datetime for chronological order...
âœ… Successfully retrieved 10885 records
ğŸ“Š Shape: (10885, 25)

ğŸ”§ Step 2: Preprocessing data...
ğŸ”§ Preprocessing data...
   ğŸ§¹ Handling missing values...
   ğŸ“Š Ensuring engineered features are properly calculated...
   â• Creating lag features for pollutants...
   â• Creating lag features for pm2_5_nowcast...
   â• Creating lag features for pm10_nowcast...
   â• Creating lag features for co_ppm_8hr_avg...
   â• Creating lag features for no2_ppb...
   âœ… After preprocessing: 10880 records

ğŸ“Š Step 3: Creating time series splits...
ğŸ“Š Creating time series splits...

âŒ Error in training pipeline: Too many splits=5 for number of samples=10880 with test_size=2176 and gap=0.

âœ… XGBoost training completed successfully!
   Result: (None, None, None)

======================================================================
ğŸ“Š TRAINING SUMMARY
======================================================================
â° Completed at: 2026-01-29 02:35:20 PKT
âœ… Successful: 3/3 models
   âœ… RandomForest
   âœ… LightGBM
   âœ… XGBoost

ğŸ‰ All models trained successfully!
2026-01-29 02:35:20,966 INFO: Closing external client and cleaning up certificates.
Connection closed.
